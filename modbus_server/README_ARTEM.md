# üè≠ –ü–õ–ö210 –í–µ–±-—Å–µ—Ä–≤–µ—Ä –¥–ª—è –ê—Ä—Ç–µ–º–∞

**–î–∞—Ç–∞:** 17 —Å–µ–Ω—Ç—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫:** –ê–ª–µ–∫—Å–∞–Ω–¥—Ä (ginko.press)

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ü–õ–ö210 —á–µ—Ä–µ–∑ Modbus TCP. 
–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç REST API –∏ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è 90 –±–∏—Ç–∞–º–∏ –≤ 6 Holding Registers.

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ü–õ–ö:
- **IP:** 195.208.131.189
- **–ü–æ—Ä—Ç:** 502
- **Unit ID:** 1
- **–ü—Ä–æ—Ç–æ–∫–æ–ª:** Modbus TCP
- **–¢–∞–π–º–∞—É—Ç:** 5 —Å–µ–∫—É–Ω–¥

### –£–ø—Ä–∞–≤–ª—è–µ–º—ã–µ —Ä–µ—Å—É—Ä—Å—ã:
- **Holding Registers:** 0, 1, 2, 3, 4, 5
- **–í—Å–µ–≥–æ –±–∏—Ç–æ–≤:** 90 (Register 0-4: –ø–æ 16 –±–∏—Ç–æ–≤, Register 5: 10 –±–∏—Ç–æ–≤)
- **–¢–∏–ø –¥–∞–Ω–Ω—ã—Ö:** 16-–±–∏—Ç–Ω—ã–µ —Å–ª–æ–≤–∞ (WORD)

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:
```bash
pip install -r requirements.txt
```

### 2. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞:
```bash
python3 plc210_webserver.py
```

### 3. –û—Ç–∫—Ä—ã—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
```
http://localhost:5000
```

## üì° REST API Endpoints

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤—Å–µ—Ö —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤
```http
GET /api/status
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "data": {
    "timestamp": "2025-09-17T22:30:00.123456",
    "registers": {
      "register_0": {
        "value": 1234,
        "bits": [0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 1, 0, 0]
      },
      // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã
    },
    "connection_status": true,
    "last_error": null
  }
}
```

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –±–∏—Ç–∞
```http
POST /api/set_bit
Content-Type: application/json

{
  "register": 0,
  "bit": 5,
  "state": true
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "message": "–ë–∏—Ç 5 –≤ Register 0 —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ –í–ö–õ"
}
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –±–∏—Ç–∞
```http
GET /api/get_bit?register=0&bit=5
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "register": 0,
  "bit": 5,
  "state": true
}
```

### –ß—Ç–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–∞
```http
GET /api/read_register?register=0
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "register": 0,
  "value": 1234,
  "hex": "0x04D2",
  "binary": "0000010011010010",
  "bits": [0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 1, 0, 0]
}
```

### –ó–∞–ø–∏—Å—å –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Ä–µ–≥–∏—Å—Ç—Ä
```http
POST /api/write_register
Content-Type: application/json

{
  "register": 0,
  "value": 1234
}
```

### –í–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ –≤—Å–µ—Ö –±–∏—Ç–æ–≤
```http
POST /api/turn_all
Content-Type: application/json

{
  "state": true
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "message": "–í—Å–µ 90 –±–∏—Ç–æ–≤ —É—Å–ø–µ—à–Ω–æ –≤–∫–ª—é—á–µ–Ω—ã",
  "success_count": 90,
  "total_count": 90
}
```

### –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏
```http
GET /api/connection
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "connection": {
    "host": "195.208.131.189",
    "port": 502,
    "unit_id": 1,
    "timeout": 5.0,
    "connected": true,
    "last_error": null
  }
}
```

## üéØ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –∫–æ–¥–µ

### Python (requests):
```python
import requests

# –í–∫–ª—é—á–∏—Ç—å –±–∏—Ç 0 –≤ Register 0
response = requests.post('http://localhost:5000/api/set_bit', 
                        json={'register': 0, 'bit': 0, 'state': True})
print(response.json())

# –ü–æ–ª—É—á–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤—Å–µ—Ö —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤
response = requests.get('http://localhost:5000/api/status')
data = response.json()
if data['success']:
    registers = data['data']['registers']
    print(f"Register 0 value: {registers['register_0']['value']}")
```

### JavaScript (fetch):
```javascript
// –í—ã–∫–ª—é—á–∏—Ç—å –±–∏—Ç 5 –≤ Register 2
fetch('/api/set_bit', {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify({register: 2, bit: 5, state: false})
})
.then(response => response.json())
.then(data => console.log(data));

// –ü–æ–ª—É—á–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –±–∏—Ç–∞
fetch('/api/get_bit?register=1&bit=10')
.then(response => response.json())
.then(data => {
    if (data.success) {
        console.log(`Bit ${data.bit} in Register ${data.register}: ${data.state}`);
    }
});
```

### cURL:
```bash
# –í–∫–ª—é—á–∏—Ç—å –≤—Å–µ –±–∏—Ç—ã
curl -X POST http://localhost:5000/api/turn_all \
     -H "Content-Type: application/json" \
     -d '{"state": true}'

# –ü—Ä–æ—á–∏—Ç–∞—Ç—å Register 3
curl "http://localhost:5000/api/read_register?register=3"

# –ó–∞–ø–∏—Å–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ 0xAAAA –≤ Register 1
curl -X POST http://localhost:5000/api/write_register \
     -H "Content-Type: application/json" \
     -d '{"register": 1, "value": 43690}'
```

## üó∫Ô∏è –ú–∞–ø–ø–∏–Ω–≥ –±–∏—Ç–æ–≤

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤:
- **Register 0:** –ë–∏—Ç—ã 0-15 (16 –±–∏—Ç–æ–≤)
- **Register 1:** –ë–∏—Ç—ã 0-15 (16 –±–∏—Ç–æ–≤)
- **Register 2:** –ë–∏—Ç—ã 0-15 (16 –±–∏—Ç–æ–≤)
- **Register 3:** –ë–∏—Ç—ã 0-15 (16 –±–∏—Ç–æ–≤)
- **Register 4:** –ë–∏—Ç—ã 0-15 (16 –±–∏—Ç–æ–≤)
- **Register 5:** –ë–∏—Ç—ã 0-9 (10 –±–∏—Ç–æ–≤, –±–∏—Ç—ã 10-15 –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è)

### –û–±—â–∏–π –∏–Ω–¥–µ–∫—Å –±–∏—Ç–æ–≤:
```
–û–±—â–∏–π –±–∏—Ç 0  = Register 0, Bit 0
–û–±—â–∏–π –±–∏—Ç 15 = Register 0, Bit 15
–û–±—â–∏–π –±–∏—Ç 16 = Register 1, Bit 0
...
–û–±—â–∏–π –±–∏—Ç 89 = Register 5, Bit 9
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### 1. **–û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å:**
- ‚ùå **Input Registers –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã** (–Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –≤ CODESYS)
- ‚ùå **–ù–µ—Ç —á—Ç–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è** —Å —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –≤—ã—Ö–æ–¥–æ–≤
- ‚úÖ **–ú–æ–∂–Ω–æ —á–∏—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è** –≤ Holding Registers

### 2. **–û—Ç–≤–µ—Ç—ã –ü–õ–ö:**
- ‚úÖ **–ó–∞–ø–∏—Å—å —Ä–∞–±–æ—Ç–∞–µ—Ç** (–∫–æ–º–∞–Ω–¥—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ CODESYS)
- ‚ö†Ô∏è **–û—Ç–≤–µ—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ–ø–æ–ª–Ω—ã–º–∏** (—ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –ü–õ–ö)
- ‚úÖ **–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤–∏–¥–Ω—ã –≤ CODESYS** –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

### 3. **–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ:**
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ** –ø—Ä–∏ —Ä–∞–∑—Ä—ã–≤–∞—Ö —Å–≤—è–∑–∏
- ‚úÖ **Thread-safe** –æ–ø–µ—Ä–∞—Ü–∏–∏
- ‚úÖ **–¢–∞–π–º–∞—É—Ç—ã –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ç–ª–∞–¥–∫–∞

### –õ–æ–≥–∏:
- **–§–∞–π–ª:** `plc210_webserver.log`
- **–§–æ—Ä–º–∞—Ç:** Timestamp - Level - Message
- **–£—Ä–æ–≤–Ω–∏:** INFO, WARNING, ERROR

### –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:
- **URL:** http://localhost:5000
- **–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ** –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫—É–Ω–¥—ã
- **–í–∏–∑—É–∞–ª—å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** –≤—Å–µ–º–∏ 90 –±–∏—Ç–∞–º–∏
- **–°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è** –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

## üõ†Ô∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ IP/–ø–æ—Ä—Ç–∞:
```python
# –í —Ñ–∞–π–ª–µ plc210_webserver.py, —Å—Ç—Ä–æ–∫–∞ ~90
config = ModbusConfig(
    host="195.208.131.189",  # <- –ò–∑–º–µ–Ω–∏—Ç—å IP
    port=502,                # <- –ò–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—Ç
    unit_id=1,
    timeout=5.0
)
```

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤–µ–±-–ø–æ—Ä—Ç–∞:
```python
# –í —Ñ—É–Ω–∫—Ü–∏–∏ main(), —Å—Ç—Ä–æ–∫–∞ ~850
app.run(
    host='0.0.0.0',
    port=5000,  # <- –ò–∑–º–µ–Ω–∏—Ç—å –≤–µ–±-–ø–æ—Ä—Ç
    debug=False,
    threaded=True
)
```

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

**–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫:** –ê–ª–µ–∫—Å–∞–Ω–¥—Ä  
**Telegram:** @ginko  
**Email:** ginko.press@gmail.com

## üìù –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

### v1.0 (17.09.2025)
- ‚úÖ –ü–µ—Ä–≤–∞—è —Ä–∞–±–æ—á–∞—è –≤–µ—Ä—Å–∏—è
- ‚úÖ REST API –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 90 –±–∏—Ç–∞–º–∏ –≤ 6 —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ö
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

---

**üéØ –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É!** üöÄ
