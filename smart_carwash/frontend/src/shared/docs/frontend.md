# Документация фронтенда

## Последние обновления

### Исправления от 2024-12-19
- ✅ Исправлена проблема с редактированием номера бокса - теперь номер нельзя изменить при редактировании
- ✅ Добавлена колонка ID в таблицу боксов для лучшей идентификации
- ✅ Исправлены некликабельные ссылки в модальных окнах - добавлены стили и z-index
- ✅ Добавлен реальный API вызов для получения деталей пользователя (getUserById)
- ✅ Все ссылки переходов теперь работают корректно

### Предыдущие исправления
- ✅ Централизованное преобразование camelCase в snake_case во всех API запросах
- ✅ Исправлены фильтры API для корректной работы с бэкендом
- ✅ Добавлены модальные окна для деталей пользователей и сессий
- ✅ Исправлены JSON-схемы при создании боксов
- ✅ Добавлена навигация между сессиями, пользователями и боксами

## Архитектура

### Структура приложения
```
src/
├── apps/
│   ├── admin/          # Админский интерфейс
│   ├── cashier/        # Интерфейс кассира
│   ├── home/           # Главная страница
│   └── telegram/       # Telegram Mini App
├── shared/
│   ├── components/     # Общие компоненты
│   ├── services/       # API сервисы
│   ├── utils/          # Утилиты
│   └── styles/         # Стили и темы
```

### Ключевые компоненты

#### ApiService
Централизованный сервис для работы с API. Автоматически преобразует camelCase в snake_case.

**Важные методы:**
- `getWashBoxes(filters)` - получение списка боксов
- `createWashBox(data)` - создание бокса
- `updateWashBox(id, data)` - обновление бокса
- `getUsers(filters)` - получение списка пользователей
- `getUserById(userId)` - получение деталей пользователя
- `getSessions(filters)` - получение списка сессий

#### Утилиты
- `toSnakeCase(obj)` - рекурсивное преобразование ключей в snake_case
- `toSnakeCaseQuery(obj)` - преобразование для query параметров

## Стили и темы

### Тема по умолчанию
```javascript
const lightTheme = {
  primaryColor: '#007bff',
  primaryColorDark: '#0056b3',
  textColor: '#333',
  cardBackground: '#fff',
  // ...
};
```

### Стилизованные компоненты
Все компоненты используют styled-components для консистентного дизайна.

## API Интеграция

### Автоматическое преобразование форматов
Все API запросы автоматически преобразуют camelCase в snake_case:

```javascript
// Фронтенд (camelCase)
ApiService.createWashBox({
  boxNumber: 1,
  serviceType: 'wash'
});

// Бэкенд получает (snake_case)
{
  "box_number": 1,
  "service_type": "wash"
}
```

### Обработка ошибок
Все API методы включают обработку ошибок и логирование.

## Компоненты админки

### WashBoxManagement
- Управление боксами мойки
- Создание, редактирование, удаление
- Фильтрация по статусу и типу услуги
- **Номер бокса нельзя редактировать**

### UserManagement
- Управление пользователями
- Просмотр деталей в модальном окне
- Навигация к сессиям пользователя
- **Реальные API вызовы для получения деталей**

### SessionManagement
- Управление сессиями
- Детальная информация о сессиях
- Навигация между связанными сущностями

## Безопасность

### Аутентификация
- JWT токены в localStorage
- Автоматическое добавление токена к запросам
- Защищенные маршруты

### Валидация
- Валидация форм на клиенте
- Проверка типов данных
- Санитизация входных данных

## Производительность

### Оптимизации
- Ленивая загрузка компонентов
- Мемоизация дорогих вычислений
- Оптимизированные запросы к API

### Кэширование
- Кэширование данных пользователей
- Локальное хранение настроек
- Оптимизация повторных запросов
